<?xml version='1.0' encoding='UTF-8'?>
<Rule>
  <规则编号>SQLE00012</规则编号>
  <级别>
    <当前级别>notice</当前级别>
  </级别>
  <数据库类型>MySQL</数据库类型>
  <规则种类>最佳实践</规则种类>
  <规则简述>建议使用BIGINT类型表示小数</规则简述>
  <规则描述>在MySQL中，对于金额等需要高精度计算的小数，建议使用BIGINT类型表示，以避免浮点数精度问题。例如，可以用分来表示金额，1元在数据库中用整型表示为100。</规则描述>
  <规则场景>
    <原理说明 数据库版本="MySQL 5.7.25" 检查方式="不连库审核" 适用句型="CREATE TABLE、ALTER TABLE">
      <示例>
      原理说明：
```sql
      MySQL使用二进制来存储浮点型十进制数据（FLOAT，DOUBLE）；在十进制转化为二进制数据时，不可避免地会造成精度丢失，造成计算结果差异。虽然DECIMAL类型可以保证精度，但在某些场景下，如跨系统的精度计算，使用BIGINT代替DECIMAL会更有利于保证业务数据精度。例如：用分来表示金额，1元在数据库中整型表示为100。

```
      示例：
```sql
      CREATE TABLE products (
          id INT PRIMARY KEY,
          price DECIMAL(10, 2)
      );
      ALTER TABLE products ADD price2 DECIMAL(10, 2);    
```
      </示例>
      <检查流程描述>
      1. 对于"CREATE TABLE..."语句，如果存在DECIMAL类型字段，则报告违反规则。
      2. 对于"ALTER TABLE..."语句，执行与上述相同的检查。
      </检查流程描述>
      <知识文档>
      1. DECIMAL Data Type Characteristics
      https://dev.mysql.com/doc/refman/5.7/en/precision-math-decimal-characteristics.html

      2. 02 | 字段：这么多字段类型，该怎么定义？
      https://time.geekbang.org/column/article/350470

      3. 你不一定了解MySQL中的Decimal数据类型
      https://blog.csdn.net/u014282578/article/details/128452776
      </知识文档>
    </原理说明>
  </规则场景>
  <规则缺陷 />
  <标签>
    <分类 名称="操作对象">
      <分类值>字段</分类值>
    </分类>
    <分类 名称="SQL分类">
      <分类值>DDL</分类值>
    </分类>
    <分类 名称="审核目的">
      <分类值>保障正确性</分类值>
    </分类>
  <分类 名称="审核精确度"><分类值>不连库审核</分类值></分类></标签>
  <完成情况>完成</完成情况>
</Rule>